$Id: DESIGN,v 1.5 2002/01/29 15:40:50 alexis Exp $

Database format
---------------

The namespace database consists of a number of records, where the key is the
domain name (owner name) of the data, and the data is a set of precompiled
answers in para-wire format.

Key:	dname in RFC1035 format. 

Data:
	struct domain {
		size_t size;			/* Size of the entire record in bytes */
		u_int16_t flags;			/* Flags, see db.h */
		struct answer {
			size_t size;		/* Size of this answer in bytes */
			u_int16_t type;		/* query type this answer serves in wire format */
			u_int16_t ancount;	/* Number of answers */
			u_int16_t nscount;	/* Number of ns records */
			u_int16_t arcount;	/* Number of additional records */
			u_int16_t ptrlen;		/* Number of pointers to be updated */
			u_int16_t rrslen;		/* Number of pointers of the resource records offsets */
			size_t	datalen;	/* The size of the data */
			u_int16_t ptrs[...];	/* Offsets of the pointers in the data section */
			u_int16_t rrs[...];	/* Offsets of the resource record sets */
			u_int16_t	data[...];	/* The precompiled answer in wire format */
		}[...];
	};
